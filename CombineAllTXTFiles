rem THIS BATCH FILE WILL LOOP THROUGH ALL FILES ENDING IN .txt IN THE DIRECTORY THIS BATCH FILE IS LOCATED IN
rem IT WILL STORE THE CONTENTS OF EACH FILE IN AN OUTPUT FILE CALLED combinedresults.txt
rem IF THE OUTPUT FILE ALREADY EXISTS, IT WILL BE OVERWRITTEN
rem THE FILE WILL BE STORED IN A SUBDIRECTORY OF THE DIRECTORY THIS BATCH FILE IS LOCATED IN CALLED combinedresults
rem IF THE SUBDIRECTORY DOESN'T EXIST IT WILL BE CREATED
rem THIS BATCH FILE WILL EXECUTE THE QUICKEST IF RUN FROM THE LOCAL COMPUTER ON WHICH IT RESIDES, BUT RUNNING IT FROM A UNC PATH IS POSSIBLE

rem SET VARIABLES
set currentpath=%~dp0
set commentstart=/**************************************************************************************************
set commentbodyprefix=*
set commentend=**************************************************************************************************/
set outputfiledirectory=combinedresults
set outputfilename=combinedresults.txt

rem CREATE SUBDIRECTORY IF IT DOESN'T ALREADY EXIST
rem DELETE OUTPUT FILE IF IT ALREADY EXISTS
if not exist "%currentpath%%outputfiledirectory%\" (mkdir "%currentpath%%outputfiledirectory%\") else (if exist "%currentpath%%outputfiledirectory%\%outputfilename%" del "%currentpath%%outputfiledirectory%\%outputfilename%")

rem LOOP THROUGH ALL .txt FILES IN THE DIRECTORY THIS BATCH FILE IS LOCATED IN AND WRITE THE FILE NAME AND ITS CONTENTS TO THE OUTPUT FILE
for %%f in ("%currentpath%*.txt") do echo %commentstart% >>"%currentpath%%outputfiledirectory%\%outputfilename%" & echo %commentbodyprefix% %%f >>"%currentpath%%outputfiledirectory%\%outputfilename%" & echo %commentend% >>"%currentpath%%outputfiledirectory%\%outputfilename%" & type "%%f" >>"%currentpath%%outputfiledirectory%\%outputfilename%" & echo: >>"%currentpath%%outputfiledirectory%\%outputfilename%" & echo: >>"%currentpath%%outputfiledirectory%\%outputfilename%"

rem ALLOW USER TO SEE THE COMMAND WINDOW
pause
